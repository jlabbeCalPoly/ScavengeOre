local ExploitHandler = {}

--[[
	Store each instance of a cloned mesh for easy cleanup
]]
local instanceTracker = {}

function ExploitHandler.onPlayerAdded(player: Player)
	instanceTracker[player.UserId] = {time(), 0}
end

function ExploitHandler.onPlayerLeaving(player: Player)
	instanceTracker[player.UserId] = nil
end

function ExploitHandler.onRemoteReceived(player: Player)
	if instanceTracker[player.UserId] then
		local timeStamp = time()
		if timeStamp - instanceTracker[player.UserId][1] > 1 then
			instanceTracker[player.UserId][2] = 0
			instanceTracker[player.UserId][1] = timeStamp
		else
			instanceTracker[player.UserId][2] += 1
			if instanceTracker[player.UserId][2] > 50 then
				warn("Excessive remote firing, kicked player with user id: "..player.UserId)
				player:Kick("Excessive remote firing")
				return false
			end
		end
	end
	
	return true
end

return ExploitHandler